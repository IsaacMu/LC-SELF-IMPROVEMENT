# 30. Substring with Concatenation of All Words

# Solution

```python
class Solution:
    def findSubstring(self, s: str, words: List[str]) -> List[int]:
        words_count = collections.Counter(words)
        n, k, word_len = len(s), len(words), len(words[0])
        ans = []
        
        def sliding_window(left):
            words_found = collections.defaultdict(int)
            words_used = 0
            word_overflow = False
            for right in range(left, n, word_len):
                if right + word_len > n:
                    break
                word = s[right: right+word_len]
                if word not in words_count:
                    words_found = collections.defaultdict(int)
                    word_overflow = False
                    words_used = 0
                    left = right + word_len
                else:
                    while right-left == k*word_len or word_overflow:
                        word_left = s[left:left+word_len]
                        left = left+word_len
                        words_found[word_left] -= 1
                        if words_found[word_left] == words_count[word_left]:
                            word_overflow = False
                        else:
                            words_used -= 1
                    words_found[word] += 1
                    if words_found[word] > words_count[word]:
                        word_overflow = True
                    else:
                        words_used += 1
                        
                    if words_used == k and not word_overflow:
                        ans.append(left)
        for i in range(word_len):
            sliding_window(i)
        return ans

```

